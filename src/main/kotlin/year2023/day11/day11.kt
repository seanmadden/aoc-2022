package year2023.day11

import java.awt.Point
import java.awt.geom.Point2D
import kotlin.math.abs
import kotlin.math.exp

val testInput = """
    ...#......
    .......#..
    #.........
    ..........
    ......#...
    .#........
    .........#
    ..........
    .......#..
    #...#.....
""".trimIndent()

val puzzleInput = """
    ......#.....#.........................#...........#..........#.....#.......#..............#.................................................
    .....................#....................................................................................#........#........#.......#.......
    .........................................................#............................#..................................................#..
    .........................#.......#..............................#............................#.................#............................
    ..................#...................................................................................#.....................................
    ...........................................#....................................#.................................................#.........
    ...........................................................#..........#..........................#..........................................
    ............#...............#..............................................................#................................................
    ...#.................#.............................................................................................#........................
    ........#..........................#.................#....................#.................................................................
    .................#............................#..................................#..................#...........................#...........
    ........................................#.................#............................#...................#...............................#
    ...............................#..................#..................................................................................#......
    ..............#.........#...................................................................................................................
    ......................................................#....................................#.....#....................#.....................
    #..................#........#.............#......................#.................#.....................#.....................#............
    ............................................................................................................................................
    ........#....................................................................................................#......................#.....#.
    ................................#............#...............#...........#............#.....................................................
    .................................................................................................................#..........................
    ................#..........................................................................#................................................
    .....................#.................#..........#............................#.............................................#..............
    ......#................................................#....................................................................................
    ...................................#................................#..................#............#.........#........................#....
    ..........................................#.................................................................................................
    ............................................................................................#.........................#.....................
    .............................#..............................................................................................................
    #...............#......#.................................#..........................#.............................#.........................
    .................................#.......................................................................#...................#..............
    ....#.....................................................................#....................#..........................................#.
    ............................................#.........#..........................#...............................................#..........
    ............................................................................................................................................
    .........................#....................................#........................................#................#...................
    .......#...........................#..................................................#.....#...............................................
    .................................................................................................................#...................#......
    .............#...............................................................#..................#...........................#...............
    ..................#.........................................................................................................................
    .........#............................#........#.........#.........#................................................#...................#...
    ............................................................................................................................................
    ......................#..................................................................................#.......................#..........
    ...........................................................................#........#............#..........................................
    ............#..............#.........................................#......................................................................
    .....#............#.................................#......................................#...............................#...............#
    ............................................................................................................................................
    #.........................................#.................................................................................................
    ........................#..........#...........#..............#...................................#.........................................
    ........................................................#..........................#.......................#....................#...........
    ...........................................................................#................................................................
    ..#....................................#...........................#...................#....................................................
    .......#............................................#................................................................#......................
    ..............#............#...............................................................#..................#.............................
    ......................................................................#.........#....................................................#......
    ............................................................................................................................................
    ..........#..........#.........................#............#...........................#........#..........................................
    ...........................................................................#............................#....................#...........#..
    .............................#..................................................................................#...........................
    ..........................................#.................................................................................................
    .....#..........#................#..................................................#......#.............................#......#...........
    ............................................................................................................................................
    .#.........#..............#..................#........#..........#.....................................#....................................
    ........................................#.....................................................#..........................................#..
    ..............................#...........................................#................................#.........#......................
    ............................................................................................................................................
    ............................................................................................................................................
    ......#...........................#.................#...........................#.......................#................#.............#....
    ..........................#.............................................#...................................................................
    ................................................................#...........................................................................
    ........................................#...............#.............................#.....#......................................#........
    ......................#...........................................................................#..............#..........................
    ..................................................#.........#......#...........................................................#........#...
    ..#..............#..........................#................................#.....#........................................................
    ............................................................................................................................................
    ....................................#.................................#........................#.......#......#..........#..................
    .......#...............................................................................#...................................................#
    ...............#.......................................#........................................................................#...........
    ...........................................#................................................................................................
    .......................#..............#............................................#................................................#.......
    ............................................................................................................................................
    .#..........................#............................#..................................#..........#......#.............................
    ............................................................................................................................................
    ............................................................................................................................................
    ............#......#.....#.......................#...............................................#..........................................
    ..........................................................................................#..............#..................................
    .....................................................................#............................................#.........................
    ................................................................................#.........................................#.................
    ....#..........#..................................................................................................................#.....#...
    ........................................................#...................................#......#........................................
    ........#...........#......#......................#.....................#............#......................................................
    ...................................#..............................#...........................................................#.............
    .................................................................................................................#..........................
    .........................................#............#....................#..................#......................................#......
    ........................#.....................#...........................................................................................#.
    ...................................................................................................#.....#..................................
    ............................................................................................................................................
    .....................................#...................#...............................................................#.....#............
    .....................#........................................#.......................#.....................................................
    .............#............#.....#...........................................#......................................................#.......#
    .......#...................................................................................#..............#.................................
    #.......................................#.............................#.............................................#.......................
    ...................................#............................#..............................#......................................#.....
    ..............................................................................................................#.............#...............
    ........................................................................................#..........#........................................
    ...............#..........................#..............#..........#.......................................................................
    ......#..................................................................#.......................................#.................#........
    ................................................#...........................................................#.................#.............
    #...................#........#...................................................................#..........................................
    ............................................#...................................#...........#.......................#.......................
    ........#...................................................................................................................................
    .....................................#............#.........#......#................................................................#.......
    .................#....................................................................#..............#......................................
    ................................................................................................#.........................#.................
    ...........................#..............#.................................................................................................
    ..........#.................................................................................................................................
    ................................................#.......#...........................#........#....................#................#........
    .......................................#.........................#..................................#......#................................
    ..................................#.................#....................................#.................................#...............#
    ...........................................#................................................................................................
    ......#.....................................................................................................................................
    ......................#.......#......................................#......#...............................................................
    ................................................#......#...............................................................#................#...
    ..............#................................................................................#.............................#..............
    ..........................................#.............................#........................................#..........................
    .........................#...........................................................................#..............................#.......
    ....................................#.......................................................................................................
    ....#...............#..............................................#....................#...........................#.......................
    ..........................................................#.................................................................................
    ..........................................................................#.......................#.........................................
    ..............#.............................................................................................#...................#.........#.
    .......................#.....................#.......................#............................................#.........................
    ...............................#...................................................#........................................................
    .................#......................................................................#............................................#......
    .......#...................................................#................#........................#..................#...................
    .#...........#..............#...............................................................................................................
    .....................#............................#.................#............#..............#...........................................
    ...........................................#...........#.................#.................................#................................
    ...............................#......................................................#....................................................#
    .............................................................................#..............................................................
    .................................................................................................................................#..........
    .......................#...........#..........#............#.....#........................#.............................................#...
    .#..........#...............#......................................................#......................#......#..........................
""".trimIndent()

val part2TestInput = """
""".trimIndent()

val test2Input = """
""".trimIndent()

fun part1() {
}

fun part2(values: List<Long>) {
}

fun MutableList<StringBuilder>.transpose(): MutableList<StringBuilder> {
    val transposedUniverse = mutableListOf<StringBuilder>()

    for (line in this) {
        transposedUniverse.add(StringBuilder(" ".repeat(this.size)))
    }
    for ((idx, line) in this.withIndex()) {
        for ((jdx, char) in line.withIndex()) {
            transposedUniverse[jdx].setCharAt(idx, char)
        }
    }

    return transposedUniverse
}

fun Point2D.moveTo(otherPoint: Point2D): Int {
    return (abs(x - otherPoint.x) + abs(y - otherPoint.y)).toInt()
}

fun main(args: Array<String>) {
    val universe = mutableListOf<StringBuilder>()

    // Expand on horizontal
    puzzleInput.lines().forEachIndexed { idx, line ->
        if (line.contains('#')) {
            universe.add(StringBuilder(line))
        } else {
            universe.add(StringBuilder(line))
            universe.add(StringBuilder(line))
        }
    }

    val transposedUniverse = universe.transpose()

    // Expand on vertical:
    universe.clear()
    transposedUniverse.forEachIndexed { idx, line ->
        if (line.contains('#')) {
            universe.add(StringBuilder(line))
        } else {
            universe.add(StringBuilder(line))
            universe.add(StringBuilder(line))
        }
    }

    // transpose again
    val expandedUniverse = universe.transpose()
    val galaxySet = mutableListOf<Point2D>()

    for ((idx, line) in expandedUniverse.withIndex()) {
        for ((jdx, char) in line.withIndex()) {
            if (char == '#') {
                println("Galaxy found at $idx, $jdx")
                galaxySet.add(Point(idx, jdx))
            }
        }
    }

    val distances = mutableListOf<Int>()
    for ((idx, firstPoint) in galaxySet.withIndex()) {
        for ((jdx, secondPoint) in galaxySet.subList(idx, galaxySet.size).withIndex()) {
            println("Distance between points ${idx + 1} and ${jdx + idx + 1} is ${firstPoint.moveTo(secondPoint)}")
            distances.add(firstPoint.moveTo(secondPoint))
        }
    }

    println("Sum of all distances ${distances.sum()}")

    val startTime = System.currentTimeMillis()

    val endTime = System.currentTimeMillis()
    println("millis elapsed ${endTime - startTime}")
}
